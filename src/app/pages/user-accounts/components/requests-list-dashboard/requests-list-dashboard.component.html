<div
  class="requests-list-container"
  *ngIf="{ allDataForUserSupport: allDataForUserSupport$ | async } as params"
>
  <mat-progress-bar
    mode="indeterminate"
    *ngIf="!params?.allDataForUserSupport"
  ></mat-progress-bar>
  <div class="p-2">
    <table class="table mat-elevation-z1 p-2">
      <thead class="custom-header-bg">
        <tr>
          <th style="width: 15px">SN</th>
          <th>Request</th>
          <th>Date</th>
          <th style="width: 200px">Actions</th>
        </tr>
      </thead>
      <tbody *ngIf="params?.allDataForUserSupport">
        <ng-container
          *ngFor="
            let dataRow of params?.allDataForUserSupport?.data
              | FilterFormRequests: 'status':'REJECTED';
            let count = index
          "
        >
          <tr>
            <td>
              {{ count + 1 }}
            </td>
            <td>
              <div [innerHTML]="dataRow?.message?.message"></div>
            </td>
            <td>
              {{ dataRow?.timeSinceResponseSent }}
            </td>
            <td>
              <button
                mat-flat-button
                (click)="onToggleDetails($event, dataRow)"
              >
                View details
              </button>
            </td>
          </tr>
          <tr *ngIf="viewMoreDetails[dataRow?.referenceId]">
            <td colspan="100%">
              <table class="table">
                <thead>
                  <tr>
                    <th>SN</th>
                    <th>Names</th>
                    <th>Phone</th>
                    <th>Username</th>
                    <th>Password</th>
                  </tr>
                </thead>
                <tbody>
                  <ng-container
                    *ngFor="let user of dataRow?.payload; let count = index"
                  >
                    <tr
                      [ngClass]="{ 'created-user': user?.status == 'CREATED' }"
                    >
                      <td>
                        {{ count + 1 }}
                      </td>
                      <td>
                        {{ user?.firstName + ' ' + user?.surname }}
                      </td>
                      <td>
                        {{ user?.phoneNumber }}
                      </td>
                      <td>
                        {{
                          user?.username
                            ? user?.username
                            : 'Waiting to be given'
                        }}
                      </td>
                      <td>
                        {{
                          user?.password
                            ? user?.password
                            : 'Waiting to be given'
                        }}
                      </td>
                    </tr>
                  </ng-container>
                </tbody>
              </table>
            </td>
          </tr>
        </ng-container>
      </tbody>
    </table>
  </div>
  <div mat-dialog-actions class="d-flex justify-content-end">
    <button
      mat-stroked-button
      [matMenuTriggerFor]="menu"
      style="
        box-sizing: border-box;
        font-family: Roboto, sans-serif;
        -webkit-tap-highlight-color: rgba(0, 0, 0, 0);
        cursor: pointer;
        text-decoration: none;
        font-size: inherit;
        font-weight: inherit;
        vertical-align: bottom;
        background-color: #276696;
        color: #fff;
        transition: all 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;
        overflow: hidden;
        text-align: center;
        float: right;
        text-align: right;
        margin-top: 1rem;
        bottom: 1.5rem;
        right: 1.5rem;
        position: fixed;
        z-index: 1005;
        border-radius: 50%;
      "
    >
      New
    </button>

    <mat-menu #menu="matMenu">
      <!-- <button mat-menu-item (click)="openUploadingPage($event)">
        Bulk (Uploading)
      </button> -->
      <button mat-menu-item [routerLink]="'/user-accounts/request'">
        Request
      </button>
    </mat-menu>
  </div>
</div>
